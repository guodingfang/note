<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>函数 | 技术笔记汇总</title>
    <meta name="description" content="技术笔记汇总">
    <link rel="icon" href="/note/logo.png">
    
    <link rel="preload" href="/note/assets/css/0.styles.723ec28c.css" as="style"><link rel="preload" href="/note/assets/js/app.639aaa1d.js" as="script"><link rel="preload" href="/note/assets/js/2.18cea2a3.js" as="script"><link rel="preload" href="/note/assets/js/131.99855906.js" as="script"><link rel="prefetch" href="/note/assets/js/10.d74c4aaa.js"><link rel="prefetch" href="/note/assets/js/100.160ef226.js"><link rel="prefetch" href="/note/assets/js/101.d89cfcb4.js"><link rel="prefetch" href="/note/assets/js/102.41543122.js"><link rel="prefetch" href="/note/assets/js/103.f46c5a54.js"><link rel="prefetch" href="/note/assets/js/104.8afda8d0.js"><link rel="prefetch" href="/note/assets/js/105.8b49f398.js"><link rel="prefetch" href="/note/assets/js/106.0a237536.js"><link rel="prefetch" href="/note/assets/js/107.fd156660.js"><link rel="prefetch" href="/note/assets/js/108.cec707fc.js"><link rel="prefetch" href="/note/assets/js/109.b08fc514.js"><link rel="prefetch" href="/note/assets/js/11.e7bbc63e.js"><link rel="prefetch" href="/note/assets/js/110.999289db.js"><link rel="prefetch" href="/note/assets/js/111.ec825371.js"><link rel="prefetch" href="/note/assets/js/112.63a9fae3.js"><link rel="prefetch" href="/note/assets/js/113.8d88e9c4.js"><link rel="prefetch" href="/note/assets/js/114.45aea35d.js"><link rel="prefetch" href="/note/assets/js/115.1a9e8d50.js"><link rel="prefetch" href="/note/assets/js/116.9e1366fe.js"><link rel="prefetch" href="/note/assets/js/117.aef7b2f8.js"><link rel="prefetch" href="/note/assets/js/118.d0894cfb.js"><link rel="prefetch" href="/note/assets/js/119.6f1a233e.js"><link rel="prefetch" href="/note/assets/js/12.4e2e5b55.js"><link rel="prefetch" href="/note/assets/js/120.9cb76c94.js"><link rel="prefetch" href="/note/assets/js/121.51db0e41.js"><link rel="prefetch" href="/note/assets/js/122.a774b6e0.js"><link rel="prefetch" href="/note/assets/js/123.2495f550.js"><link rel="prefetch" href="/note/assets/js/124.72a5001b.js"><link rel="prefetch" href="/note/assets/js/125.3002453d.js"><link rel="prefetch" href="/note/assets/js/126.a0580de3.js"><link rel="prefetch" href="/note/assets/js/127.b94a348d.js"><link rel="prefetch" href="/note/assets/js/128.19cb69b3.js"><link rel="prefetch" href="/note/assets/js/129.6694712d.js"><link rel="prefetch" href="/note/assets/js/13.bb2d73f3.js"><link rel="prefetch" href="/note/assets/js/130.36726bd4.js"><link rel="prefetch" href="/note/assets/js/132.a887285f.js"><link rel="prefetch" href="/note/assets/js/133.3331cbc8.js"><link rel="prefetch" href="/note/assets/js/134.50211f20.js"><link rel="prefetch" href="/note/assets/js/135.6db45b06.js"><link rel="prefetch" href="/note/assets/js/136.b6f8c569.js"><link rel="prefetch" href="/note/assets/js/137.32bae06b.js"><link rel="prefetch" href="/note/assets/js/138.9a0c4498.js"><link rel="prefetch" href="/note/assets/js/139.bc89350a.js"><link rel="prefetch" href="/note/assets/js/14.99e459f9.js"><link rel="prefetch" href="/note/assets/js/140.d470778d.js"><link rel="prefetch" href="/note/assets/js/141.0e78c0c6.js"><link rel="prefetch" href="/note/assets/js/142.24fd38c1.js"><link rel="prefetch" href="/note/assets/js/143.6b33397a.js"><link rel="prefetch" href="/note/assets/js/144.e541ff87.js"><link rel="prefetch" href="/note/assets/js/145.dfc7a5d1.js"><link rel="prefetch" href="/note/assets/js/146.b8f4d1c2.js"><link rel="prefetch" href="/note/assets/js/147.2fba978b.js"><link rel="prefetch" href="/note/assets/js/15.ebfb8f45.js"><link rel="prefetch" href="/note/assets/js/16.9d49488e.js"><link rel="prefetch" href="/note/assets/js/17.569ba4d1.js"><link rel="prefetch" href="/note/assets/js/18.c8798bfa.js"><link rel="prefetch" href="/note/assets/js/19.60f574a1.js"><link rel="prefetch" href="/note/assets/js/20.45207a90.js"><link rel="prefetch" href="/note/assets/js/21.a2904a46.js"><link rel="prefetch" href="/note/assets/js/22.efd74e56.js"><link rel="prefetch" href="/note/assets/js/23.126123a5.js"><link rel="prefetch" href="/note/assets/js/24.90d786b5.js"><link rel="prefetch" href="/note/assets/js/25.dfff9848.js"><link rel="prefetch" href="/note/assets/js/26.d4980a90.js"><link rel="prefetch" href="/note/assets/js/27.f265c0a3.js"><link rel="prefetch" href="/note/assets/js/28.0b4655c2.js"><link rel="prefetch" href="/note/assets/js/29.1c841b66.js"><link rel="prefetch" href="/note/assets/js/3.97ea9125.js"><link rel="prefetch" href="/note/assets/js/30.14fb0251.js"><link rel="prefetch" href="/note/assets/js/31.83ecbc44.js"><link rel="prefetch" href="/note/assets/js/32.676ceef2.js"><link rel="prefetch" href="/note/assets/js/33.dd1928f3.js"><link rel="prefetch" href="/note/assets/js/34.e4f8b59e.js"><link rel="prefetch" href="/note/assets/js/35.c34ce175.js"><link rel="prefetch" href="/note/assets/js/36.34ac0299.js"><link rel="prefetch" href="/note/assets/js/37.835c49dc.js"><link rel="prefetch" href="/note/assets/js/38.7b2a15c1.js"><link rel="prefetch" href="/note/assets/js/39.b323af2f.js"><link rel="prefetch" href="/note/assets/js/4.c8fd7a8d.js"><link rel="prefetch" href="/note/assets/js/40.e2a077a4.js"><link rel="prefetch" href="/note/assets/js/41.24bd3142.js"><link rel="prefetch" href="/note/assets/js/42.32054c08.js"><link rel="prefetch" href="/note/assets/js/43.f692f1af.js"><link rel="prefetch" href="/note/assets/js/44.cbafa45a.js"><link rel="prefetch" href="/note/assets/js/45.c4abea6a.js"><link rel="prefetch" href="/note/assets/js/46.1f70a305.js"><link rel="prefetch" href="/note/assets/js/47.5e6582ef.js"><link rel="prefetch" href="/note/assets/js/48.27b2112e.js"><link rel="prefetch" href="/note/assets/js/49.3fc1c54b.js"><link rel="prefetch" href="/note/assets/js/5.e0fe9c1d.js"><link rel="prefetch" href="/note/assets/js/50.f6773725.js"><link rel="prefetch" href="/note/assets/js/51.cb2d49b0.js"><link rel="prefetch" href="/note/assets/js/52.0cb675fa.js"><link rel="prefetch" href="/note/assets/js/53.0a7d1250.js"><link rel="prefetch" href="/note/assets/js/54.a2207b8d.js"><link rel="prefetch" href="/note/assets/js/55.b62860f5.js"><link rel="prefetch" href="/note/assets/js/56.4643e80f.js"><link rel="prefetch" href="/note/assets/js/57.79f29367.js"><link rel="prefetch" href="/note/assets/js/58.499d1cc9.js"><link rel="prefetch" href="/note/assets/js/59.6a110758.js"><link rel="prefetch" href="/note/assets/js/6.26ae280a.js"><link rel="prefetch" href="/note/assets/js/60.220d416e.js"><link rel="prefetch" href="/note/assets/js/61.e6ae8610.js"><link rel="prefetch" href="/note/assets/js/62.450a8b23.js"><link rel="prefetch" href="/note/assets/js/63.238bc8af.js"><link rel="prefetch" href="/note/assets/js/64.c556d7a5.js"><link rel="prefetch" href="/note/assets/js/65.0b2b8f74.js"><link rel="prefetch" href="/note/assets/js/66.8d38ac9a.js"><link rel="prefetch" href="/note/assets/js/67.713c7ae8.js"><link rel="prefetch" href="/note/assets/js/68.9de919ca.js"><link rel="prefetch" href="/note/assets/js/69.2592d868.js"><link rel="prefetch" href="/note/assets/js/7.bb118cfd.js"><link rel="prefetch" href="/note/assets/js/70.0466fd46.js"><link rel="prefetch" href="/note/assets/js/71.a00608d4.js"><link rel="prefetch" href="/note/assets/js/72.1bcabb0f.js"><link rel="prefetch" href="/note/assets/js/73.78366d6d.js"><link rel="prefetch" href="/note/assets/js/74.51084859.js"><link rel="prefetch" href="/note/assets/js/75.85681aa6.js"><link rel="prefetch" href="/note/assets/js/76.c6c9f004.js"><link rel="prefetch" href="/note/assets/js/77.868c406f.js"><link rel="prefetch" href="/note/assets/js/78.bd98c817.js"><link rel="prefetch" href="/note/assets/js/79.823c967e.js"><link rel="prefetch" href="/note/assets/js/8.8d8d5490.js"><link rel="prefetch" href="/note/assets/js/80.7e38de0b.js"><link rel="prefetch" href="/note/assets/js/81.f4ee7ab9.js"><link rel="prefetch" href="/note/assets/js/82.2bddefbf.js"><link rel="prefetch" href="/note/assets/js/83.1ab0c706.js"><link rel="prefetch" href="/note/assets/js/84.e6725b2a.js"><link rel="prefetch" href="/note/assets/js/85.637004f2.js"><link rel="prefetch" href="/note/assets/js/86.df5d585f.js"><link rel="prefetch" href="/note/assets/js/87.6264f320.js"><link rel="prefetch" href="/note/assets/js/88.e54ffe1f.js"><link rel="prefetch" href="/note/assets/js/89.84627f4a.js"><link rel="prefetch" href="/note/assets/js/9.eb9999aa.js"><link rel="prefetch" href="/note/assets/js/90.06375289.js"><link rel="prefetch" href="/note/assets/js/91.baa716db.js"><link rel="prefetch" href="/note/assets/js/92.471de1da.js"><link rel="prefetch" href="/note/assets/js/93.853cd704.js"><link rel="prefetch" href="/note/assets/js/94.9ccee478.js"><link rel="prefetch" href="/note/assets/js/95.6ce9b4cf.js"><link rel="prefetch" href="/note/assets/js/96.75494f51.js"><link rel="prefetch" href="/note/assets/js/97.df197e36.js"><link rel="prefetch" href="/note/assets/js/98.cbab8cf8.js"><link rel="prefetch" href="/note/assets/js/99.906477ea.js">
    <link rel="stylesheet" href="/note/assets/css/0.styles.723ec28c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/note/" class="home-link router-link-active"><!----> <span class="site-name">技术笔记汇总</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/note/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">技术笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/base/" class="nav-link">基础</a></li><li class="dropdown-item"><h4>进阶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/typescript/" class="nav-link router-link-active">TypeScript</a></li><li class="dropdown-subitem"><a href="/note/regex/" class="nav-link">正则表达式</a></li></ul></li><li class="dropdown-item"><h4>框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">React</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">Vue</a></li></ul></li><li class="dropdown-item"><h4>微信开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/wx_official_account/" class="nav-link">微信公众号</a></li><li class="dropdown-subitem"><a href="/note/wx_mini_program/" class="nav-link">微信小程序</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端工程</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/sass/" class="nav-link">Sass</a></li><li class="dropdown-item"><!----> <a href="/note/less/" class="nav-link">Less</a></li><li class="dropdown-item"><!----> <a href="/note/gulp/" class="nav-link">Gulp</a></li><li class="dropdown-item"><!----> <a href="/note/npm/" class="nav-link">Npm</a></li><li class="dropdown-item"><!----> <a href="/note/webpack/" class="nav-link">Webpack</a></li><li class="dropdown-item"><!----> <a href="/note/babel/" class="nav-link">Babel</a></li><li class="dropdown-item"><!----> <a href="/note/git/" class="nav-link">Git</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">nodejs开发</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/nodejs/" class="nav-link">NodeJs</a></li><li class="dropdown-item"><!----> <a href="/note/koa2/" class="nav-link">Koa2</a></li><li class="dropdown-item"><!----> <a href="/note/express/" class="nav-link">Express</a></li><li class="dropdown-item"><!----> <a href="/note/mongodb/" class="nav-link">MongoDB</a></li><li class="dropdown-item"><!----> <a href="/note/redis/" class="nav-link">Redis</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">应用框架</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/ant_design_pro/" class="nav-link">Ant Design Pro</a></li><li class="dropdown-item"><!----> <a href="/note/react_native/" class="nav-link">React Native</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/note/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">技术笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/base/" class="nav-link">基础</a></li><li class="dropdown-item"><h4>进阶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/typescript/" class="nav-link router-link-active">TypeScript</a></li><li class="dropdown-subitem"><a href="/note/regex/" class="nav-link">正则表达式</a></li></ul></li><li class="dropdown-item"><h4>框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">React</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">Vue</a></li></ul></li><li class="dropdown-item"><h4>微信开发</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/wx_official_account/" class="nav-link">微信公众号</a></li><li class="dropdown-subitem"><a href="/note/wx_mini_program/" class="nav-link">微信小程序</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端工程</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/sass/" class="nav-link">Sass</a></li><li class="dropdown-item"><!----> <a href="/note/less/" class="nav-link">Less</a></li><li class="dropdown-item"><!----> <a href="/note/gulp/" class="nav-link">Gulp</a></li><li class="dropdown-item"><!----> <a href="/note/npm/" class="nav-link">Npm</a></li><li class="dropdown-item"><!----> <a href="/note/webpack/" class="nav-link">Webpack</a></li><li class="dropdown-item"><!----> <a href="/note/babel/" class="nav-link">Babel</a></li><li class="dropdown-item"><!----> <a href="/note/git/" class="nav-link">Git</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">nodejs开发</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/nodejs/" class="nav-link">NodeJs</a></li><li class="dropdown-item"><!----> <a href="/note/koa2/" class="nav-link">Koa2</a></li><li class="dropdown-item"><!----> <a href="/note/express/" class="nav-link">Express</a></li><li class="dropdown-item"><!----> <a href="/note/mongodb/" class="nav-link">MongoDB</a></li><li class="dropdown-item"><!----> <a href="/note/redis/" class="nav-link">Redis</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">应用框架</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/ant_design_pro/" class="nav-link">Ant Design Pro</a></li><li class="dropdown-item"><!----> <a href="/note/react_native/" class="nav-link">React Native</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>TypeScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/note/typescript/base_type.html" class="sidebar-link">基础类型</a></li><li><a href="/note/typescript/statement.html" class="sidebar-link">变量声明</a></li><li><a href="/note/typescript/interfaces.html" class="sidebar-link">接口</a></li><li><a href="/note/typescript/class.html" class="sidebar-link">类</a></li><li><a href="/note/typescript/func.html" class="active sidebar-link">函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/typescript/func.html#介绍" class="sidebar-link">介绍</a></li><li class="sidebar-sub-header"><a href="/note/typescript/func.html#函数-2" class="sidebar-link">函数</a></li><li class="sidebar-sub-header"><a href="/note/typescript/func.html#函数类型" class="sidebar-link">函数类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/typescript/func.html#为函数定义类型" class="sidebar-link">为函数定义类型</a></li><li class="sidebar-sub-header"><a href="/note/typescript/func.html#书写完整函数类型" class="sidebar-link">书写完整函数类型</a></li><li class="sidebar-sub-header"><a href="/note/typescript/func.html#推断类型" class="sidebar-link">推断类型</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/typescript/func.html#可选参数和默认参数" class="sidebar-link">可选参数和默认参数</a></li><li class="sidebar-sub-header"><a href="/note/typescript/func.html#剩余参数" class="sidebar-link">剩余参数</a></li><li class="sidebar-sub-header"><a href="/note/typescript/func.html#this" class="sidebar-link">this</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/typescript/func.html#this-和箭头函数" class="sidebar-link">this 和箭头函数</a></li><li class="sidebar-sub-header"><a href="/note/typescript/func.html#回调函数里的this参数" class="sidebar-link">回调函数里的this参数</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/typescript/func.html#重载" class="sidebar-link">重载</a></li></ul></li><li><a href="/note/typescript/generics.html" class="sidebar-link">泛型</a></li><li><a href="/note/typescript/enums.html" class="sidebar-link">枚举</a></li><li><a href="/note/typescript/type_inference.html" class="sidebar-link">类型推断</a></li><li><a href="/note/typescript/type_compatibility.html" class="sidebar-link">类型兼容性</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="函数"><a href="#函数" aria-hidden="true" class="header-anchor">#</a> 函数</h1> <h2 id="介绍"><a href="#介绍" aria-hidden="true" class="header-anchor">#</a> 介绍</h2> <p>函数是 JavaScript 应用程序的基础。它帮助你实现抽象层，模拟类，信息隐藏和模块。在 TypeScript 里，虽然已经支持类，命名空间和模块，但函数仍然是主要的定义行为的地方。TypeScript 为 JavaScript 函数添加了额外的功能，让我们可以更容易地使用。</p> <h2 id="函数-2"><a href="#函数-2" aria-hidden="true" class="header-anchor">#</a> 函数</h2> <p>和 JavaScript 一样，TypeScript 函数可以创建有名字的函数和匿名函数。可以随意选择适合应用程序的方式，无论是定义一系列的API函数还是只使用一次的函数</p> <p>通过下面的例子可以快速回想起这两种 JavaScript 中的函数：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token function-variable function">myAdd</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>在 JavaScript 里，函数可以使用函数体外部的变量。当函数这样做时，我们说它捕获了这些变量。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> z <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">addToZ</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="函数类型"><a href="#函数类型" aria-hidden="true" class="header-anchor">#</a> 函数类型</h2> <h3 id="为函数定义类型"><a href="#为函数定义类型" aria-hidden="true" class="header-anchor">#</a> 为函数定义类型</h3> <p>让我们为上面那个函数添加类型：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token function-variable function">myAdd</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>我们可以给每个参数添加类型之后再为函数本身添加返回值类型。TypeScript 能够根据返回值自动判断返回的类型，因此我们通常忽略它。</p> <h3 id="书写完整函数类型"><a href="#书写完整函数类型" aria-hidden="true" class="header-anchor">#</a> 书写完整函数类型</h3> <p>现在我们已经为函数指定了类型，下面让我们写出函数的完整类型。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token function-variable function">myAdd</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">:</span><span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span><span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function-variable function">number</span> <span class="token operator">=</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>函数类型包含两部分：参数类型和返回值类型。当写出完整的函数类型的时候，这两部分都是需要的。我们以参数列表的形式写出参数类型，为每一个参数指定一个名字和类型。这个名字只是为了增加可读性。也可以这样写：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token function-variable function">myAdd</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">baseValue<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> increment<span class="token punctuation">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function-variable function">number</span> <span class="token operator">=</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>只要参数类型是匹配的，那么就认为它是有效的函数类型，而不在乎参数名是否正确。</p> <p>第二部分是返回值类型。对于返回值，我们在函数和返回值类型之前使用（<code>=&gt;</code>） 符号，使之清晰明了。如之前提到的，返回值类型是函数类型的必要部分，如果函数没有任何返回值，你也必须指定返回值类型为 <code>void</code> 而不能留空。</p> <p>函数的类型只是由参数类型和返回值组成的。函数中使用的捕获变量不会体现在类型里。实际上，这些变量是函数的隐藏状态并不是组成 API 的一部分。</p> <h3 id="推断类型"><a href="#推断类型" aria-hidden="true" class="header-anchor">#</a> 推断类型</h3> <p>判断这个例子的时候，你会发现如果你在赋值语句的一段指定了类型而另一边没有类型的话，TypeScript 编辑器会自动识别出类型：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// myAdd has the full function type</span>
<span class="token keyword">let</span> <span class="token function-variable function">myAdd</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// The parameters `x` and `y` have the type number</span>
<span class="token keyword">let</span> <span class="token function-variable function">myAdd</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">baseValue<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> increment<span class="token punctuation">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function-variable function">number</span> <span class="token operator">=</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>这叫做“按上下文归类”，是类型推论的一种。 它帮助我们更好地为程序指定类型。</p> <h2 id="可选参数和默认参数"><a href="#可选参数和默认参数" aria-hidden="true" class="header-anchor">#</a> 可选参数和默认参数</h2> <p>TypeScript 里的每个函数参数都是必须的。这不是指不能传递 <code>null</code> 或 <code>undefined</code> 作为参数，而是说编辑器检测用户是否为每个参数都传入了值。编辑器还会假设只有这些参数会被传递进函数。简短的说，传递给一个函数的参数必须与函数期望的参数个数一致。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token parameter">firstName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> firstName <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> lastName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> result1 <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// error, too few parameters</span>
<span class="token keyword">let</span> result2 <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Adams&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Sr.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// error, too many parameters</span>
<span class="token keyword">let</span> result3 <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Adams&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// ah, just right</span>
</code></pre></div><p>JavaScript 里，每个参数都是可选的，可传可不传。没有传递的时候，它的值就是 <code>undefined</code>。在 TypeScript 里 我们可以在参数名旁使用 <code>?</code> 实现可选参数的功能。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token parameter">firstName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> lastName<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>lastName<span class="token punctuation">)</span>
    <span class="token keyword">return</span> firstName <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> lastName<span class="token punctuation">;</span>
  <span class="token keyword">else</span>
    <span class="token keyword">return</span> firstName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> result1 <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// works correctly now</span>
<span class="token keyword">let</span> result2 <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Adams&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Sr.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// error, too many parameters</span>
<span class="token keyword">let</span> result3 <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Adams&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ah, just right</span>
</code></pre></div><p>可选参数必须跟在必需参数后面。</p> <p>在 TypeScript 里，我们也可以为参数提供一个默认值当用户没有传递这个参数或者传递的值是 <code>undefined</code> 时。它们叫做有默认初始化值的参数。让我们修改上例，把 last name 的默认值设置为 &quot;Smith&quot;。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">buildName</span><span class="token punctuation">(</span>firstName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> lastName <span class="token operator">=</span> <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> firstName <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> lastName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> result1 <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// works correctly now, returns &quot;Bob Smith&quot;</span>
<span class="token keyword">let</span> result2 <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> undefined<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// still works, also returns &quot;Bob Smith&quot;</span>
<span class="token keyword">let</span> result3 <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Adams&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Sr.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// error, too many parameters</span>
<span class="token keyword">let</span> result4 <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Adams&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// ah, just right</span>
</code></pre></div><p>在所以必须参数后面的带默认值初始化的参数都是可选的，与可选参数一样，在调用函数时可以省略。也就是说可选参数与末尾的默认参数共享参数类型。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token parameter">firstName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> lastName<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 和
 **/</span>

<span class="token keyword">function</span> <span class="token function">buildName</span><span class="token punctuation">(</span>firstName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> lastName <span class="token operator">=</span> <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>共享同样的类型 <code>(fisrtName: string, lastName?: string) =&gt; string</code>。默认参数的默认值取消了，只保留了它一个可选参数的信息。</p> <p>与普通可选参数不同的时，带默认值的参数不需要放在必须参数后面。如果带默认值的参数出现在必须参数前面，用户必须传递明确的 <code>undefined</code> 值来获得默认值。 例如，我们重写最后一个例子，让 <code>firstName</code> 是带默认值的参数：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">buildName</span><span class="token punctuation">(</span>firstName <span class="token operator">=</span> <span class="token string">&quot;Will&quot;</span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> firstName <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> lastName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> result1 <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// error, too few parameters</span>
<span class="token keyword">let</span> result2 <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Adams&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Sr.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// error, too many parameters</span>
<span class="token keyword">let</span> result3 <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Adams&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// okay and returns &quot;Bob Adams&quot;</span>
<span class="token keyword">let</span> result4 <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span>undefined<span class="token punctuation">,</span> <span class="token string">&quot;Adams&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// okay and returns &quot;Will Adams&quot;</span>
</code></pre></div><h2 id="剩余参数"><a href="#剩余参数" aria-hidden="true" class="header-anchor">#</a> 剩余参数</h2> <p>必要参数，默认参数和可选参数有个共同点：它们表示某一个参数。有时，你想同时操作多个参数，或者你并不知道会有多少个参数传递进来。在 JavaScript 里，可以使用 <code>arguments</code> 来访问所有传入的参数。</p> <p>在 TypeScript 里，可以把所以参数收集到一个变量里：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token parameter">firstName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token operator">...</span>restOfName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> firstName <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> restOfName<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> employeeName <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">&quot;Joseph&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Samuel&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Lucas&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;MacKinzie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>剩余参数会被当做数量不限的可选参数。可以一个都没有，同样也可以有任意个。编辑器创建参数数组，名字是在省略号（<code>...</code>）后面给定的名字，可以在函数体内使用这个数组。</p> <p>这个省略号也会在带有剩余参数的函数类型定义上使用到：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token parameter">firstName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token operator">...</span>restOfName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> firstName <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> restOfName<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token function-variable function">buildNameFun</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">fname<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token operator">...</span>rest<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span> <span class="token operator">=</span> buildName<span class="token punctuation">;</span>
</code></pre></div><h2 id="this"><a href="#this" aria-hidden="true" class="header-anchor">#</a> this</h2> <h3 id="this-和箭头函数"><a href="#this-和箭头函数" aria-hidden="true" class="header-anchor">#</a> this 和箭头函数</h3> <p>JavaScript 里，<code>this</code> 的值在函数被调用时候才会指定。这个既强大又灵活的特点，但是你需要花时间弄清楚函数调用的上下文是什么。但众所周知，这不是一件很简单的事，尤其是在返回一个函数或将函数当做参数传递的时候。</p> <p>下面看一个例子：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> deck <span class="token operator">=</span> <span class="token punctuation">{</span>
  suits<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;hearts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;spades&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;clubs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;diamonds&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  cards<span class="token punctuation">:</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">createCardPicker</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> pickedCard <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> pickedSuit <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>pickedCard <span class="token operator">/</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">return</span> <span class="token punctuation">{</span>suit<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>suits<span class="token punctuation">[</span>pickedSuit<span class="token punctuation">]</span><span class="token punctuation">,</span> card<span class="token punctuation">:</span> pickedCard <span class="token operator">%</span> <span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> cardPicker <span class="token operator">=</span> deck<span class="token punctuation">.</span><span class="token function">createCardPicker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> pickedCard <span class="token operator">=</span> <span class="token function">cardPicker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;card: &quot;</span> <span class="token operator">+</span> pickedCard<span class="token punctuation">.</span>card <span class="token operator">+</span> <span class="token string">&quot; of &quot;</span> <span class="token operator">+</span> pickedCard<span class="token punctuation">.</span>suit<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>可以看到 <code>createCardPicker</code> 是个函数，并且它又返回了一个函数。如果我们尝试运行这个程序，会发现并没有弹出对话框而是报错了。因为 <code>createCardPicker</code> 返回的函数里的 <code>this</code> 被设置成了 <code>window</code> 而不是 <code>deck</code> 对象。因为我们只是独立的调用了 <code>cardPicker()</code>。顶级的非方法式调用会将 <code>this</code> 视为 <code>window</code>。（注意：在严格模式下，<code>this</code> 为 <code>undefined</code> 而不是 <code>window</code>）。</p> <p>为了解决这个问题，我们可以在函数被返回时就绑定好正确的 <code>this</code>。这样的话，无论之后怎么使用它，都会引用绑定的 <code>deck</code> 对象。我们需要改变函数表达式来使用 ECMAScript6 箭头语法。箭头函数能保存函数创建是的 <code>this</code> 值，而不是调用时的值：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> deck <span class="token operator">=</span> <span class="token punctuation">{</span>
  suits<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;hearts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;spades&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;clubs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;diamonds&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  cards<span class="token punctuation">:</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">createCardPicker</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// NOTE: the line below is now an arrow function, allowing us to capture 'this' right here</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> pickedCard <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> pickedSuit <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>pickedCard <span class="token operator">/</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">return</span> <span class="token punctuation">{</span>suit<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>suits<span class="token punctuation">[</span>pickedSuit<span class="token punctuation">]</span><span class="token punctuation">,</span> card<span class="token punctuation">:</span> pickedCard <span class="token operator">%</span> <span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> cardPicker <span class="token operator">=</span> deck<span class="token punctuation">.</span><span class="token function">createCardPicker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> pickedCard <span class="token operator">=</span> <span class="token function">cardPicker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;card: &quot;</span> <span class="token operator">+</span> pickedCard<span class="token punctuation">.</span>card <span class="token operator">+</span> <span class="token string">&quot; of &quot;</span> <span class="token operator">+</span> pickedCard<span class="token punctuation">.</span>suit<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>现在 TypeScript 知道 <code>createCardPicker</code> 期望在某个 <code>Deck</code> 对象上调用。也就是说 <code>this</code> 是 <code>Deck</code> 类型的，而非 <code>any</code>，因此 <code>--noImplicitThis</code> 不会报错了。</p> <h3 id="回调函数里的this参数"><a href="#回调函数里的this参数" aria-hidden="true" class="header-anchor">#</a> 回调函数里的this参数</h3> <p>当你将一个函数传递到某个库函数里在稍后被调用时，你可能也见过回调函数里的 <code>this</code> 会报错。因为当回调函数被调用时，它会被当做一个普通函数调用，<code>this</code> 将为 <code>undefined</code>。稍作改动，就可以通过 <code>this</code> 参数来避免错误。首先，库函数的作者要指定 <code>this</code> 类型：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">UIElement</span> <span class="token punctuation">{</span>
  <span class="token function">addClickListener</span><span class="token punctuation">(</span><span class="token function-variable function">onclick</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">this</span><span class="token punctuation">:</span> <span class="token keyword">void</span><span class="token punctuation">,</span> e<span class="token punctuation">:</span> Event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a href="https://typescript.bootcss.com/functions.html" target="_blank" rel="noopener noreferrer">详情<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="重载"><a href="#重载" aria-hidden="true" class="header-anchor">#</a> 重载</h2> <p>JavaScript 本身是个动态语音。JavaScript 里函数根据传入不同的参数返回不同类型的数据是很常见的。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> suits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;hearts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;spades&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;clubs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;diamonds&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">pickCard</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token punctuation">{</span>
  <span class="token comment">// Check to see if we're working with an object/array</span>
  <span class="token comment">// if so, they gave us the deck and we'll pick the card</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">==</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> pickedCard <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> x<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> pickedCard<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Otherwise just let them pick the card</span>
  <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">==</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> pickedSuit <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>x <span class="token operator">/</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> suit<span class="token punctuation">:</span> suits<span class="token punctuation">[</span>pickedSuit<span class="token punctuation">]</span><span class="token punctuation">,</span> card<span class="token punctuation">:</span> x <span class="token operator">%</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> myDeck <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> suit<span class="token punctuation">:</span> <span class="token string">&quot;diamonds&quot;</span><span class="token punctuation">,</span> card<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> suit<span class="token punctuation">:</span> <span class="token string">&quot;spades&quot;</span><span class="token punctuation">,</span> card<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> suit<span class="token punctuation">:</span> <span class="token string">&quot;hearts&quot;</span><span class="token punctuation">,</span> card<span class="token punctuation">:</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> pickedCard1 <span class="token operator">=</span> myDeck<span class="token punctuation">[</span><span class="token function">pickCard</span><span class="token punctuation">(</span>myDeck<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;card: &quot;</span> <span class="token operator">+</span> pickedCard1<span class="token punctuation">.</span>card <span class="token operator">+</span> <span class="token string">&quot; of &quot;</span> <span class="token operator">+</span> pickedCard1<span class="token punctuation">.</span>suit<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> pickedCard2 <span class="token operator">=</span> <span class="token function">pickCard</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;card: &quot;</span> <span class="token operator">+</span> pickedCard2<span class="token punctuation">.</span>card <span class="token operator">+</span> <span class="token string">&quot; of &quot;</span> <span class="token operator">+</span> pickedCard2<span class="token punctuation">.</span>suit<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>pickCard</code> 方法根据传入参数的不同会返回两种不同的类型。  如果传入的是代表纸牌的对象，函数作用是从中抓一张牌。 如果用户想抓牌，我们告诉他抓到了什么牌。 但是这怎么在类型系统里表示呢。</p> <p>方法是为同一个函数提供多个函数类型定义来进行函数重载。 编译器会根据这个列表去处理函数的调用。 下面我们来重载 <code>pickCard</code> 函数。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> suits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;hearts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;spades&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;clubs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;diamonds&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">pickCard</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">:</span> <span class="token punctuation">{</span>suit<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> card<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">pickCard</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>suit<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> card<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">pickCard</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token punctuation">{</span>
  <span class="token comment">// Check to see if we're working with an object/array</span>
  <span class="token comment">// if so, they gave us the deck and we'll pick the card</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">==</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> pickedCard <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> x<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> pickedCard<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Otherwise just let them pick the card</span>
  <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">==</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> pickedSuit <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>x <span class="token operator">/</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> suit<span class="token punctuation">:</span> suits<span class="token punctuation">[</span>pickedSuit<span class="token punctuation">]</span><span class="token punctuation">,</span> card<span class="token punctuation">:</span> x <span class="token operator">%</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> myDeck <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> suit<span class="token punctuation">:</span> <span class="token string">&quot;diamonds&quot;</span><span class="token punctuation">,</span> card<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> suit<span class="token punctuation">:</span> <span class="token string">&quot;spades&quot;</span><span class="token punctuation">,</span> card<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> suit<span class="token punctuation">:</span> <span class="token string">&quot;hearts&quot;</span><span class="token punctuation">,</span> card<span class="token punctuation">:</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> pickedCard1 <span class="token operator">=</span> myDeck<span class="token punctuation">[</span><span class="token function">pickCard</span><span class="token punctuation">(</span>myDeck<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;card: &quot;</span> <span class="token operator">+</span> pickedCard1<span class="token punctuation">.</span>card <span class="token operator">+</span> <span class="token string">&quot; of &quot;</span> <span class="token operator">+</span> pickedCard1<span class="token punctuation">.</span>suit<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> pickedCard2 <span class="token operator">=</span> <span class="token function">pickCard</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;card: &quot;</span> <span class="token operator">+</span> pickedCard2<span class="token punctuation">.</span>card <span class="token operator">+</span> <span class="token string">&quot; of &quot;</span> <span class="token operator">+</span> pickedCard2<span class="token punctuation">.</span>suit<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>这样改变后，重载的 <code>pickCard</code> 函数在调用的时候会进行正确的类型检查。</p> <p>为了让编译器能够选择正确的检查类型，它与 JavaScript 里的处理流程相似。 它查找重载列表，尝试使用第一个重载定义。 如果匹配的话就使用这个。 因此，在定义重载的时候，一定要把最精确的定义放在最前面。</p> <p>注意，<code>function pickCard(x: any): any</code> 并不是重载列表的一部分，因此这里只有两个重载：一个是接收对象另一个接收数字。 以其它参数调用 <code>pickCard</code> 会产生错误。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/note/typescript/class.html" class="prev">类</a></span> <span class="next"><a href="/note/typescript/generics.html">泛型</a>→
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/note/assets/js/app.639aaa1d.js" defer></script><script src="/note/assets/js/2.18cea2a3.js" defer></script><script src="/note/assets/js/131.99855906.js" defer></script>
  </body>
</html>
