(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{209:function(t,s,a){t.exports=a.p+"assets/img/umijs.6e4bf7ea.png"},210:function(t,s,a){t.exports=a.p+"assets/img/umijs-lifecycle.f40bc3a3.png"},300:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"指南"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#指南","aria-hidden":"true"}},[t._v("#")]),t._v(" 指南")]),t._v(" "),n("h2",{attrs:{id:"介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#介绍","aria-hidden":"true"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),n("p",[t._v("umi（乌米），是一个可插拔的企业级 react 应用框架。umi 以路由为基础的，支持类 next.js 的约定式路由，以及各种进阶的路由功能，并以此进行功能的扩展，比如支持路由级的按需加载。"),n("a",{attrs:{href:"https://umijs.org/zh/",target:"_blank",rel:"noopener noreferrer"}},[t._v("详情"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"特性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#特性","aria-hidden":"true"}},[t._v("#")]),t._v(" 特性")]),t._v(" "),n("ul",[n("li",[t._v("开箱即用，内置 react，react-router 等")]),t._v(" "),n("li",[t._v("类 next.js 且功能完备的路由约定，同时支持配置的路由方式")]),t._v(" "),n("li",[t._v("完善的插件体系，覆盖从源码到构建产物的每个生命周期")]),t._v(" "),n("li",[t._v("高性能，通过插件支持 PWA、以路由为单元的 code splitting 等")]),t._v(" "),n("li",[t._v("支持静态页面导出，配置各种环境，比如中台业务、无线业务、egg等")]),t._v(" "),n("li",[t._v("开发启动快，支持一键开启dll等")]),t._v(" "),n("li",[t._v("兼容I9，基于 umi-plugin-polyfills")]),t._v(" "),n("li",[t._v("完善的 TypeScript 支持，包括 d.ts 定义和 umi test")]),t._v(" "),n("li",[t._v("与dva数据流的深入融合，支持 duck directory、model 的自动加载、code splitting等等")])]),t._v(" "),n("h3",{attrs:{id:"框架"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#框架","aria-hidden":"true"}},[t._v("#")]),t._v(" 框架")]),t._v(" "),n("p",[t._v("下图是 umi 的架构图。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(209),alt:"UmiJS架构图"}})]),t._v(" "),n("h3",{attrs:{id:"从源码到上线的生命周期管理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#从源码到上线的生命周期管理","aria-hidden":"true"}},[t._v("#")]),t._v(" 从源码到上线的生命周期管理")]),t._v(" "),n("p",[t._v("市面上的框架基本都是从源码到构建产物，很少会考虑到各种发布流程，而 umi 则多走了这一步。\n下图是 umi 从源码到线上的一个流程。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(210),alt:"UmiJS从源码到上线的生命周期管理"}})]),t._v(" "),n("p",[t._v("umi 首先会加载用户的配置和插件，然后基于配置或者目录，生成一份路由配置，再基于此路由配置，把 JS/CSS 源码和 HTML 完整的串联起来。用户配置的参数和插件会影响流程里的每个环节。")]),t._v(" "),n("h3",{attrs:{id:"与-dva、roadhog-之间的关系？"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#与-dva、roadhog-之间的关系？","aria-hidden":"true"}},[t._v("#")]),t._v(" 与 dva、roadhog 之间的关系？")]),t._v(" "),n("ul",[n("li",[t._v("roadhog 是基于 webpack 的封装工具，目的是简化webpack的配置")]),t._v(" "),n("li",[t._v("umi 可以简单的理解为 roadhog + 路由，思路类似 next.js/nuxt.js ，辅以一套插件机制，目的是通过框架的方式简化 React 开发")]),t._v(" "),n("li",[t._v("dva 目前是纯粹的数据流，和 umi 以及 roadhog 之间并没有相互的依赖关系，可以分开使用也可以一起使用")])]),t._v(" "),n("h2",{attrs:{id:"快速上手"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#快速上手","aria-hidden":"true"}},[t._v("#")]),t._v(" 快速上手")]),t._v(" "),n("h3",{attrs:{id:"环境准备"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#环境准备","aria-hidden":"true"}},[t._v("#")]),t._v(" 环境准备")]),t._v(" "),n("p",[t._v("首先得有 node ，并确保 node 版本是8.10或以上")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ node -v\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(".1x\n")])])]),n("p",[t._v("推荐使用 yarn 管理 npm 依赖，并使用国内源")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 国内源")]),t._v("\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" tyarn -g\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 后面文档里的 yarn 换成 tyarn")]),t._v("\n$ tyarn -v\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 阿里内网源")]),t._v("\n$ tnpm i "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" @ali/yarn -g\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 后面文档里的 yarn 换成 ayarn")]),t._v("\n$ ayarn -v\n")])])]),n("p",[t._v("然后全局安装 umi ，确保版本是2.0.0或以上。")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" global "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" umi\n$ umi -v\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),t._v(".0\n")])])]),n("h3",{attrs:{id:"脚手架"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#脚手架","aria-hidden":"true"}},[t._v("#")]),t._v(" 脚手架")]),t._v(" "),n("p",[t._v("新建一个空的目录")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" myapp "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" myapp\n")])])]),n("p",[t._v("然后通过 umi g 创建一些页面")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ umi g page index\n$ umi g page "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("users")]),t._v("\n")])])]),n("p",[t._v("这里的page目录是页面所在的目录，umi 约定默认情况下pages下所有的js文件即路由")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ umi dev\n")])])]),n("h3",{attrs:{id:"约定式路由"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#约定式路由","aria-hidden":"true"}},[t._v("#")]),t._v(" 约定式路由")]),t._v(" "),n("p",[t._v("启动 "),n("code",[t._v("umi dev")]),t._v(" 后，会发现 pages 下多了个 "),n("code",[t._v(".umi")]),t._v(" 的目录。这是 umi 的临时目录，可以在这里做一些验证，但不要在这里修改代码，umi 重启或者 pages 下的文件修改都会重新生成这个文件夹下的文件。")]),t._v(" "),n("p",[t._v("先修改 "),n("code",[t._v("pages/index.js")])]),t._v(" "),n("div",{staticClass:"language-tsx extra-class"},[n("div",{staticClass:"highlight-lines"},[n("div",{staticClass:"highlighted"},[t._v(" ")]),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("pre",{pre:!0,attrs:{class:"language-tsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Link "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'umi/link'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" styles "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./index.css'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("className")]),n("span",{pre:!0,attrs:{class:"token script language-javascript"}},[n("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("styles"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("normal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("Page index")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Link")])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("to")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("go to /users")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Link")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n    ")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("在修改 "),n("code",[t._v("pages/users.js")])]),t._v(" "),n("div",{staticClass:"language-tsx extra-class"},[n("div",{staticClass:"highlight-lines"},[n("div",{staticClass:"highlighted"},[t._v(" ")]),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("pre",{pre:!0,attrs:{class:"language-tsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" router "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'umi/router'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" styles "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./index.css'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("className")]),n("span",{pre:!0,attrs:{class:"token script language-javascript"}},[n("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("styles"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("normal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("Page index")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onClick")]),n("span",{pre:!0,attrs:{class:"token script language-javascript"}},[n("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" router"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("goBack")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("go back")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n    ")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("就可以在 index 和 users 两个页面之间路由跳转了")]),t._v(" "),n("h3",{attrs:{id:"部署发布"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#部署发布","aria-hidden":"true"}},[t._v("#")]),t._v(" 部署发布")]),t._v(" "),n("h4",{attrs:{id:"构建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#构建","aria-hidden":"true"}},[t._v("#")]),t._v(" 构建")]),t._v(" "),n("p",[t._v("执行 "),n("code",[t._v("umi build")])]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ umi build\n\nDONE  Compiled successfully "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" 1729ms\n\nFile sizes after gzip:\n\n  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("68.04")]),t._v(" KB  dist/umi.js\n  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("83")]),t._v(" B      dist/umi.css\n")])])]),n("p",[t._v("构建产物默认生成到 "),n("code",[t._v("./dist")]),t._v(" 下")]),t._v(" "),n("h4",{attrs:{id:"本地验证"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#本地验证","aria-hidden":"true"}},[t._v("#")]),t._v(" 本地验证")]),t._v(" "),n("p",[t._v("发布之前，可以通过 "),n("code",[t._v("sever")]),t._v(" 做本地验证")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" global "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" serve\n$ serve ./dist\n\nServing"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n\n- Local:            http://localhost:5000\n- On Your Network:  http://"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("Your IP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(":5000\n\nCopied "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v(" address to clipboard"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n")])])]),n("p",[t._v("访问http://localhost:5000，正常情况下应该和 "),n("code",[t._v("umi dev")]),t._v(" 一致的。")]),t._v(" "),n("h4",{attrs:{id:"部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#部署","aria-hidden":"true"}},[t._v("#")]),t._v(" 部署")]),t._v(" "),n("p",[t._v("本地验证完，就可以部署了，通过 "),n("a",{attrs:{href:"https://zeit.co/home",target:"_blank",rel:"noopener noreferrer"}},[t._v("now"),n("OutboundLink")],1),t._v(" 来做演示")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" global "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" now\n$ now ./dist\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Deploying /private/tmp/sorrycc-1KVCmK/dist under chencheng\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Synced "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" files "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),t._v(".93KB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("2s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" https://dist-jtckzjjatx.now.sh "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("in clipboard"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("1s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Deployment complete"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n")])])]),n("h4",{attrs:{id:"测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#测试","aria-hidden":"true"}},[t._v("#")]),t._v(" 测试")]),t._v(" "),n("p",[t._v("umi 内置了基于 "),n("code",[t._v("jest")]),t._v(" 的测试工具 umi-test:")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ umi "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("\n\nOptions:\n\n    --coverage                    indicates that "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v(" coverage information should be collected and reported "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" the output\n    --collectCoverageFrom"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("glob"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("  a glob pattern relative to matching the files that coverage info needs to be collected from, e.g, --collectCoverageFrom"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("src/**/*.js\n    --detectLeaks                 debug memory leaks\n")])])]),n("h4",{attrs:{id:"配置检查"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置检查","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置检查")]),t._v(" "),n("p",[t._v("使用 umi inspect 列出配置项的内容用以检查：")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ umi inspect\n\nOptions:\n\n    --mode                specify "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),t._v(" mode "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("development or production, default is development"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    --rule "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ruleName"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("     inspect a specific module rule\n    --plugin "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("pluginName"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" inspect a specific plugin\n    --rules               list all module rule names\n    --plugins             list all plugin names\n    --verbose             show full "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" definitions "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" output\n")])])]),n("h2",{attrs:{id:"通过脚手架创建项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#通过脚手架创建项目","aria-hidden":"true"}},[t._v("#")]),t._v(" 通过脚手架创建项目")]),t._v(" "),n("p",[t._v("umi通过 create-umi 提供脚手架能力，包含：")]),t._v(" "),n("ul",[n("li",[t._v("project，通用项目脚手架，支持选择是否开启TypeScript，以及 umi-plugin-react 包含的功能")]),t._v(" "),n("li",[t._v("ant-design-pro，仅包含 ant-design-pro 布局的脚手架，具体页面可通过 umi block 添加")]),t._v(" "),n("li",[t._v("block，区块脚手架")]),t._v(" "),n("li",[t._v("plugin，插件脚手架")]),t._v(" "),n("li",[t._v("library，依赖（组件）库脚手架")])]),t._v(" "),n("h3",{attrs:{id:"创建项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建项目","aria-hidden":"true"}},[t._v("#")]),t._v(" 创建项目")]),t._v(" "),n("blockquote",[n("p",[t._v("可以通过 "),n("code",[t._v("yarn create umi")]),t._v(" 或 "),n("code",[t._v("npm create umi")]),t._v(" 使用 create-umi。推荐使用 "),n("code",[t._v("yarn create")]),t._v(" 命令，确保每次使用最新的脚手架。")])]),t._v(" "),n("p",[t._v("在新目录下使用 "),n("code",[t._v("yarn create umi")])]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" myapp "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" myapp\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" create umi\n")])])]),n("p",[t._v("创建项目的剩余内容，点击查看"),n("a",{attrs:{href:"https://umijs.org/zh/guide/create-umi-app.html#%E5%88%9B%E5%BB%BA-umi-%E9%A1%B9%E7%9B%AE",target:"_blank",rel:"noopener noreferrer"}},[t._v("其余详情"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"目录及约定"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#目录及约定","aria-hidden":"true"}},[t._v("#")]),t._v(" 目录及约定")]),t._v(" "),n("p",[t._v("在文件和目录下，umi更倾向于选择约定的方式")]),t._v(" "),n("p",[t._v("一个复杂应用的目录结构如下：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v(".\n├── dist/                          // 默认的 build 输出目录\n├── mock/                          // mock 文件所在目录，基于 express\n├── config/\n    ├── config.js                  // umi 配置，同 .umirc.js，二选一\n└── src/                           // 源码目录，可选\n    ├── layouts/index.js           // 全局布局\n    ├── pages/                     // 页面目录，里面的文件即路由\n        ├── .umi/                  // dev 临时目录，需添加到 .gitignore\n        ├── .umi-production/       // build 临时目录，会自动删除\n        ├── document.ejs           // HTML 模板\n        ├── 404.js                 // 404 页面\n        ├── page1.js               // 页面 1，任意命名，导出 react 组件\n        ├── page1.test.js          // 用例文件，umi test 会匹配所有 .test.js 和 .e2e.js 结尾的文件\n        └── page2.js               // 页面 2，任意命名\n    ├── global.css                 // 约定的全局样式文件，自动引入，也可以用 global.less\n    ├── global.js                  // 可以在这里加入 polyfill\n    ├── app.js                     // 运行时配置文件\n├── .umirc.js                      // umi 配置，同 config/config.js，二选一\n├── .env                           // 环境变量\n└── package.json\n")])])]),n("p",[t._v("目录及约定剩余内容，点击查看"),n("a",{attrs:{href:"https://umijs.org/zh/guide/app-structure.html#es6-%E8%AF%AD%E6%B3%95",target:"_blank",rel:"noopener noreferrer"}},[t._v("其余详情"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"路由"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#路由","aria-hidden":"true"}},[t._v("#")]),t._v(" 路由")]),t._v(" "),n("p",[t._v("umi 会根据 "),n("code",[t._v("pages")]),t._v(" 目录自动生成路由配置")]),t._v(" "),n("h3",{attrs:{id:"约定路由"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#约定路由","aria-hidden":"true"}},[t._v("#")]),t._v(" 约定路由")]),t._v(" "),n("h4",{attrs:{id:"基础路由"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#基础路由","aria-hidden":"true"}},[t._v("#")]),t._v(" 基础路由")]),t._v(" "),n("p",[t._v("假设 "),n("code",[t._v("pages")]),t._v(" 目录结构如下：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("+ pages/\n  + users/\n    - index.js\n    - list.js\n  - index.js\n")])])]),n("p",[t._v("那么，umi 会自动生成路由配置如下：")]),t._v(" "),n("div",{staticClass:"language-tsx extra-class"},[n("pre",{pre:!0,attrs:{class:"language-tsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" component"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./pages/index.js'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/users/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" component"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./pages/users/index.js'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/users/list'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" component"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./pages/users/list.js'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),n("h4",{attrs:{id:"动态路由"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#动态路由","aria-hidden":"true"}},[t._v("#")]),t._v(" 动态路由")]),t._v(" "),n("p",[t._v("umi 里约定，带 "),n("code",[t._v("$")]),t._v(" 前缀的目录或文件为动态路由")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("+ pages/\n  + $post/\n    - index.js\n    - comments.js\n  + users/\n    $id.js\n  - index.js\n")])])]),n("p",[t._v("会自动生成路由配置如下：")]),t._v(" "),n("div",{staticClass:"language-tsx extra-class"},[n("pre",{pre:!0,attrs:{class:"language-tsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" component"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./pages/index.js'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/users/:id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" component"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./pages/users/$id.js'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/:post/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" component"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./pages/$post/index.js'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/:post/comments'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" component"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./pages/$post/comments.js'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),n("p",[t._v("路由剩余信息，点击查看"),n("a",{attrs:{href:"https://umijs.org/zh/guide/router.html#%E7%BA%A6%E5%AE%9A%E5%BC%8F%E8%B7%AF%E7%94%B1",target:"_blank",rel:"noopener noreferrer"}},[t._v("其余详情"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"在页面间跳转"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在页面间跳转","aria-hidden":"true"}},[t._v("#")]),t._v(" 在页面间跳转")]),t._v(" "),n("p",[t._v("在 umi 里，页面之间跳转的两种方式：声明式和命令式")]),t._v(" "),n("h3",{attrs:{id:"声明式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#声明式","aria-hidden":"true"}},[t._v("#")]),t._v(" 声明式")]),t._v(" "),n("p",[t._v("基于 "),n("code",[t._v("umi/link")]),t._v(" ，通常作为 React 组件使用。")]),t._v(" "),n("div",{staticClass:"language-tsx extra-class"},[n("pre",{pre:!0,attrs:{class:"language-tsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Link "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'umi/link'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Link")])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("to")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/list"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("Go to list page")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Link")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"命令式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#命令式","aria-hidden":"true"}},[t._v("#")]),t._v(" 命令式")]),t._v(" "),n("p",[t._v("基于 "),n("code",[t._v("umi/router")]),t._v(" ，通常在事件处理中被调用。")]),t._v(" "),n("div",{staticClass:"language-tsx extra-class"},[n("pre",{pre:!0,attrs:{class:"language-tsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" router "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'umi/router'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("goToListPage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  router"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/list'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h2",{attrs:{id:"配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置")]),t._v(" "),n("h3",{attrs:{id:"配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置文件","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置文件")]),t._v(" "),n("p",[t._v("umi 允许在 "),n("code",[t._v(".umirc.js")]),t._v(" 或 "),n("code",[t._v("config/config.js")]),t._v(" （二选一，"),n("code",[t._v(".umirc.js")]),t._v(" 优先）中进行配置，支持 ES6 语法。")]),t._v(" "),n("p",[t._v("比如：")]),t._v(" "),n("div",{staticClass:"language-tsx extra-class"},[n("pre",{pre:!0,attrs:{class:"language-tsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  base"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/admin/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  publicPath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://cdn.com/foo'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  plugins"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'umi-plugin-react'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      dva"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("具体配置项详见"),n("a",{attrs:{href:"https://umijs.org/zh/config/",target:"_blank",rel:"noopener noreferrer"}},[t._v("配置"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"umi-env"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#umi-env","aria-hidden":"true"}},[t._v("#")]),t._v(" UMI_ENV")]),t._v(" "),n("p",[t._v("可以通过环境变量 "),n("code",[t._v("UMI_ENV")]),t._v(" 区分不同环境来指定配置")]),t._v(" "),n("div",{staticClass:"language-tsx extra-class"},[n("pre",{pre:!0,attrs:{class:"language-tsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// .umirc.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// .umirc.cloud.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cloud'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cloud'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// .umirc.local.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" c"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'local'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("不指定 "),n("code",[t._v("UMI_ENV")]),t._v(" 时，拿到的配置是：")]),t._v(" "),n("div",{staticClass:"language-tsx extra-class"},[n("pre",{pre:!0,attrs:{class:"language-tsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  c"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'local'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("指定 "),n("code",[t._v("UMI_ENV=cloud")]),t._v(" 时，拿到的配置是：")]),t._v(" "),n("div",{staticClass:"language-tsx extra-class"},[n("pre",{pre:!0,attrs:{class:"language-tsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cloud'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  c"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'local'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h2",{attrs:{id:"html模板"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#html模板","aria-hidden":"true"}},[t._v("#")]),t._v(" HTML模板")]),t._v(" "),n("h3",{attrs:{id:"修改默认模板"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改默认模板","aria-hidden":"true"}},[t._v("#")]),t._v(" 修改默认模板")]),t._v(" "),n("p",[t._v("新建 "),n("code",[t._v("src/pages/document.ejs")]),t._v(" , umi约定如果这个文件存在，会作为默认模板，内容上需要保证有 "),n("code",[t._v('<div id="root"></div>')]),t._v(" ， 比如：")]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token doctype"}},[t._v("<!doctype html>")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("charset")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("utf-8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Your App"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("root"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("h3",{attrs:{id:"配置模板"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置模板","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置模板")]),t._v(" "),n("p",[t._v("模板里可以通过 "),n("code",[t._v("context")]),t._v(" 来获取 umi 提供的变量，context 包含：")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("route")]),t._v("，路由对象，包含 path、component 等")]),t._v(" "),n("li",[n("code",[t._v("config")]),t._v("，用户配置信息")]),t._v(" "),n("li",[n("code",[t._v("publicPath")]),t._v("，webpack 的 "),n("code",[t._v("output.publicPath")]),t._v(" 配置")]),t._v(" "),n("li",[n("code",[t._v("env")]),t._v(" 环境变量，值为 development 或 production")]),t._v(" "),n("li",[t._v("其他在路由上通过 context 扩展的配置信息")])]),t._v(" "),n("p",[t._v("剩余配置模板内容"),n("a",{attrs:{href:"https://umijs.org/zh/guide/html-template.html#%E4%BF%AE%E6%94%B9%E9%BB%98%E8%AE%A4%E6%A8%A1%E6%9D%BF",target:"_blank",rel:"noopener noreferrer"}},[t._v("详情"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"module-processor"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#module-processor","aria-hidden":"true"}},[t._v("#")]),t._v(" Module Processor")]),t._v(" "),n("p",[t._v("如下列出的模块在 "),n("code",[t._v("umi")]),t._v(" 中都会被自动处理，所以开发者无需关心这些模块是如何被处理的，以及他们的 "),n("code",[t._v("webpack")]),t._v(" 配置是怎样的")]),t._v(" "),n("h3",{attrs:{id:"module-list"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#module-list","aria-hidden":"true"}},[t._v("#")]),t._v(" Module list")]),t._v(" "),n("ul",[n("li",[n("code",[t._v(".js, .jsx, .mjs, .jsx, .json")]),t._v("：由 babel-loader 处理")]),t._v(" "),n("li",[n("code",[t._v(".ts")]),t._v("：由 ts-loader 处理")]),t._v(" "),n("li",[n("code",[t._v(".graphql, .gql")]),t._v("：由 graphql-tag/loader 处理")]),t._v(" "),n("li",[n("code",[t._v(".css, .less, .sass")]),t._v("：由 css-loader, postcss-loader, less-loader 处理")]),t._v(" "),n("li",[n("code",[t._v(".svg")]),t._v("：由 @svgr/core 处理。使用 umi，可以用如下方式引入 svg")])]),t._v(" "),n("div",{staticClass:"language-tsx extra-class"},[n("pre",{pre:!0,attrs:{class:"language-tsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" ReactComponent "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" Avatar "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./avatar.svg'")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Example")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Avatar")])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h2",{attrs:{id:"介绍-umi-ui"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#介绍-umi-ui","aria-hidden":"true"}},[t._v("#")]),t._v(" 介绍 Umi UI")]),t._v(" "),n("p",[t._v("umi 项目的本地研发工作台")]),t._v(" "),n("h3",{attrs:{id:"特性-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#特性-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 特性")]),t._v(" "),n("ul",[n("li",[t._v("项目管理。集中式管理本地项目。")]),t._v(" "),n("li",[t._v("配置管理。umi / bigfish 常用项目配置。")]),t._v(" "),n("li",[t._v("任务管理。集成启动、构建、测试、代码规范检查、重新安装依赖等常用操作。")])]),t._v(" "),n("h3",{attrs:{id:"使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用","aria-hidden":"true"}},[t._v("#")]),t._v(" 使用")]),t._v(" "),n("blockquote",[n("p",[t._v("请确保 umi 版本在 2.9.0 或以上")])]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("$ umi ui\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);